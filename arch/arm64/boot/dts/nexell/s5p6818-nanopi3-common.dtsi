/*
 * (C) Copyright 2017 FriendlyElec Computer Tech. Co., Ltd.
 * (http://www.friendlyarm.com)
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

/memreserve/ 0x7de00000 0x00100000; /* OP-TEE SHM */
#include <dt-bindings/interrupt-controller/irq.h>
#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/input/input.h>
#include "s5p6818.dtsi"

#define PMIC_PDATA_INIT(_id, _rname, _minuv, _maxuv,	\
						_always_on, _boot_on, _init_uv,	\
						_init_enable, _slp_slots)		\
		regulator-name = _rname;			\
		regulator-min-microvolt = <_minuv>;	\
		regulator-max-microvolt = <_maxuv>;	\
		nx,id = <_id>;						\
		nx,always_on = <_always_on>;		\
		nx,boot_on = <_boot_on>;			\
		nx,init_enable = <_init_enable>;	\
		nx,init_uV = <_init_uv>;			\
		nx,sleep_slots = <_slp_slots>;

/ {
	model = "FriendlyElec boards based on Nexell s5p6818";
	compatible = "friendlyelec,nanopi3",
		   "nexell,s5p6818";

	memory {
		device_type = "memory";
		reg = <0x40000000 0x3db00000>;
	};

	aliases {
		ethernet0 = &gmac0;
	};

	nx-v4l2 {
		status = "okay";
	};

	soc {
		#include "s5p6818-pinctrl.dtsi"

		clocks {
			uart0:uart@c00a9000 { clock-frequency = <147500000>; };
			uart1:uart@c00a8000 { clock-frequency = <147500000>; };
			uart2:uart@c00aa000 { clock-frequency = <147500000>; };
			uart3:uart@c00ab000 { clock-frequency = <147500000>; };
			uart4:uart@c006e000 { clock-frequency = <147500000>; };
			/* uart5:uart@c0084000 { clock-frequency = <147500000>; }; */

			vip0:vip@c00c1000  { clock-frequency = <300000000>; };

			i2c0:i2c@c00ae000  { clock-frequency = <200000000>; };
			i2c1:i2c@c00af000  { clock-frequency = <200000000>; };
			i2c2:i2c@c00b0000  { clock-frequency = <200000000>; };

			spi0:spi@c00ac000  { clock-frequency = <100000000>; };
			spi2:spi@c00a7000  { clock-frequency = <100000000>; };

			pwm0:pwm0@c00ba000 {
				clk-input = <I_PLL2>;
				clock-frequency = <10000000>;
			};
			pwm1:pwm1@c00ba000 {
				clk-input = <I_PLL2>;
				clock-frequency = <10000000>;
			};
			pwm2:pwm2@c00be000 {
				clk-input = <I_PLL2>;
				clock-frequency = <10000000>;
			};
			pwm3:pwm3@c00be000 {
				clk-input = <I_PLL2>;
				clock-frequency = <10000000>;
			};
		};

		timer@c0017000 {
			clocks = <&timer0>, <&timer1>;
			clock-names = "timer0", "timer1";
		};

		serial0:serial@c00a1000 {
			status ="okay";
		};

		serial1:serial@c00a0000 {
			pinctrl-0 = <&serial1_pin>;
			status ="okay";
		};

		serial2:serial@c00a2000 {
			status ="okay";
		};

		serial3:serial@c00a3000 {
			status ="okay";
		};

		serial4:serial@c006d000 {
			status ="okay";
		};

		amba {
			pl08xdma0:pl08xdma@c0000000 {
				use_isr;

				ch12 {
					slave_wait_flush_dma;
				};

				ch13 {
					slave_wait_flush_dma;
				};

				ch14 {
					slave_wait_flush_dma;
				};

				ch15 {
					slave_wait_flush_dma;
				};
			};

			pl08xdma1:pl08xdma@c0001000 {
				use_isr;

				ch0 {
					slave_wait_flush_dma;
				};

				ch1 {
					slave_wait_flush_dma;
				};
			};
		};

		dw_mmc_2:dw_mmc@c0069000 {
			num-slots = <1>;
			bus-width = <4>;
			/* mmc-ddr-1_8v; */
			/* pinctrl-0 = <&sdmmc2_cclk &sdmmc2_cmd
						&sdmmc2_bus4 &sdmmc2_bus8>;
			soc,tieoff = <NX_TIEOFF_MMC_8BIT 1>; */
			cap-mmc-highspeed;
			broken-cd;
			non-removable;
			clock-frequency = <200000000>;
			card-detect-delay = <200>;
			disable-wp;
			status = "okay";
			nexell,drive_dly = <0x0>;
			nexell,drive_shift = <0x03>;
			nexell,sample_dly = <0x00>;
			nexell,sample_shift = <0x02>;
		};

		dw_mmc_0:dw_mmc@c0062000 {
			num-slots = <1>;
			bus-width = <4>;
			cap-sd-highspeed;
			clock-frequency = <100000000>;
			card-detect-delay = <200>;
			disable-wp;
			cd-gpios = <&alive_0 1 0>;
			cd-inverted;
			nexell,drive_dly = <0x0>;
			nexell,drive_shift = <0x02>;
			nexell,sample_dly = <0x00>;
			nexell,sample_shift = <0x01>;
			status = "okay";
		};

		dvfs:dynamic-freq@bb000 {
			supply_name = "vdd_arm_spu";
			supply_optional = "vdd_arm_axp";
			vdd_arm_spu-supply = <&VCC1P1_ARM_SPU>;
			vdd_arm_axp-supply = <&VCC1P1_ARM_PMIC>;
			status = "okay";
			dvfs-tables = <1400000 1200000
				 1300000 1140000
				 1200000 1100000
				 1100000 1040000
				 1000000 1040000
				  900000 1000000
				  800000 1000000
				  700000 980000
				  600000 980000
				  500000 940000
				  400000 940000>;
		};

		tmuctrl_0: tmuctrl@c0096000 {
			status = "okay";
		};

		thermal-zones {
			cpu0_thermal: cpu0-thermal {
				thermal-sensors = <&tmuctrl_0>;
				polling-delay-passive = <1000>;
				polling-delay = <1000>;
				trips {
					cpu_alert0: cpu-alert-0 {
						temperature = <80000>;
						hysteresis = <100000>;
						type = "active";
					};
					cpu_alert1: cpu-alert-1 {
						temperature = <85000>;
						hysteresis = <100000>;
						type = "passive";
					};
					cpu_alert2: cpu-alert-2 {
						temperature = <100000>;
						hysteresis = <100000>;
						type = "passive";
					};
					cpu-crit-0 {
						temperature = <115000>;
						hysteresis = <100000>;
						type = "critical";
					};
				};

				cooling-maps {
					map0 {
						trip = <&cpu_alert0>;
						cooling-device = <&cpu0 1 1>;
					};
					map1 {
						trip = <&cpu_alert1>;
						cooling-device = <&cpu0 4 4>;
					};
					map2 {
						trip = <&cpu_alert2>;
						cooling-device = <&cpu0 10 10>;
					};
				};
			};
		};

		gmac0:ethernet@c0060000 {
			pinctrl-names = "default";
			pinctrl-0 = <&gmac_pins>;

			status = "okay";
			#address-cells = <0x1>;
			#size-cells = <0x0>;

			snps,phy-addr = <7>;
			snps,reset-gpio = <&gpio_e 22 0>;
			snps,reset-active-low;
			snps,reset-delays-us = <0 10000 30000>;

			mdio {
				#address-cells = <1>;
				#size-cells = <0>;

				ethernet_phy: ethernet-phy@7 {
					reg = <7>;
					fixed-link {
						speed = <1000>;
						full-duplex;
					};
				};
			};
		};

		i2c3_gpio:i2c@3 {
			compatible = "i2c-gpio";
			gpios = <&gpio_e 31 0	/* sda */
				&gpio_e 30 0	/* scl */
				>;

			i2c-gpio,delay-us = <10>;	/* ~100 kHz */
			#address-cells = <1>;
			#size-cells = <0>;
		};

		i2c3_gpio:i2c@3 {
			spu1705@2d {
				compatible = "spu1705,fe-pmu";
				reg = <0x2d>;
				regulators {
					VCC1P1_ARM_SPU: DCDC1 {
						regulator-name = "vdd_arm_1.3V";
						regulator-min-microvolt = <905000>;
						regulator-max-microvolt = <1265000>;
						regulator-always-on;
					};
				};
			};

			axp228@34 {
				compatible = "x-powers,axp228";
				reg = <0x34>;
				interrupt-parent = <&alive_0>;
				interrupts = <0x4 IRQ_TYPE_EDGE_FALLING>;
				nx,id = <0>;
				/* vdd_arm-supply = <&VCC1P1_ARM_PMIC>; */
				/* vdd_core-supply = <&VCC1P0_CORE_PMIC>; */
				regulators {
					VCC_LDO1:
						axp22_rtcldo{ PMIC_PDATA_INIT( 0,
							"axp228_rtcldo",
							3000000, 3000000, 0, 0, 3300000,
							0, 0xF) };
					VCC_LDO2:
						axp22_aldo1 { PMIC_PDATA_INIT( 1,
							"axp228_3p3_alive",
							700000, 3300000, 1, 1, 3300000,
							1, 0xF) };
					VCC_LDO3:
						axp22_aldo2 { PMIC_PDATA_INIT( 2,
							"axp228_1p8_alive",
							700000, 3300000, 1, 1, 1800000,
							1, 0xF) };
					VCC_LDO4:
						axp22_aldo3 { PMIC_PDATA_INIT( 3,
							"axp228_1p0_alive",
							700000, 3300000, 1, 1, 1000000,
							1, 0xF) };
					VCC_LDO5:
						axp22_dldo1 { PMIC_PDATA_INIT( 4,
							"axp228_wide",
							700000, 3300000, 1, 1, 3300000,
							1, 0xF) };
					VCC_LDO6:
						axp22_dldo2 { PMIC_PDATA_INIT( 5,
							"axp228_1p8_cam",
							700000, 3300000, 0, 0, 1800000,
							0, 0xF) };
					VCC_LDO7:
						axp22_dldo3 { PMIC_PDATA_INIT( 6,
							"axp228_dldo3",
							700000, 3300000, 0, 0,  700000,
							0, 0xF) };
					VCC_LDO8:
						axp22_dldo4 { PMIC_PDATA_INIT( 7,
							"axp228_dldo4",
							700000, 3300000, 0, 0,  700000,
							0, 0xF) };
					VCC_LDO9:
						axp22_eldo1 { PMIC_PDATA_INIT( 8,
							"axp228_1p8_sys",
							700000, 3300000, 1, 1, 1800000,
							1, 0xF) };
					VCC_LDO10:
						axp22_eldo2 { PMIC_PDATA_INIT( 9,
							"axp228_3p3_wifi",
							700000, 3300000, 1, 1, 3300000,
							1, 0xF) };
					VCC_LDO11:
						axp22_eldo3 { PMIC_PDATA_INIT(10,
							"axp228_eldo3",
							700000, 3300000, 0, 0,  700000,
							0, 0xF) };
					VCC_LDO12:
						axp22_dc5ldo{ PMIC_PDATA_INIT(11,
							"axp228_1p2_cvbs",
							700000, 1400000, 0, 0, 1200000,
							0, 0xF) };
					VCC_DCDC1:
						axp22_dcdc1 { PMIC_PDATA_INIT(12,
							"axp228_3p3_sys",
							1600000, 3400000, 1, 1, 3300000,
							1, 0xF) };
					VCC1P1_ARM_PMIC:
						axp22_dcdc2 { PMIC_PDATA_INIT(13,
							"axp228_1p1_arm",
							600000, 1540000, 1, 1, 1200000,
							1, 0xF) };
					VCC1P0_CORE_PMIC:
						axp22_dcdc3 { PMIC_PDATA_INIT(14,
							"axp228_1p0_core",
							600000, 1860000, 1, 1, 1200000,
							1, 0xF) };
					VCC_DCDC4:
						axp22_dcdc4 { PMIC_PDATA_INIT(15,
							"axp228_1p5_sys",
							600000, 1540000, 1, 1, 1500000,
							1, 0xF) };
					VCC_DCDC5:
						axp22_dcdc5 { PMIC_PDATA_INIT(16,
							"axp228_1p5_ddr",
							1000000, 2550000, 1, 1, 1500000,
							1, 0xF) };
					VCC_LDOIO0:
						axp22_ldoio0{ PMIC_PDATA_INIT(17,
							"axp228_ldoio0",
							700000, 3300000, 0, 0, 1800000,
							0, 0xF) };
					VCC_LDOIO1:
						axp22_ldoio1{ PMIC_PDATA_INIT(18,
							"axp228_ldoio1",
							700000, 3300000, 0, 0, 1000000,
							0, 0xF) };
				};
			};

		};

		spdif_tx: spdiftx@c0059000 {
			#sound-dai-cells = <1>;
			pcm-bit = <16>;
			sample_rate = <48000>;
			status = "okay";
		};

		watchdog@c0019000 {
			status = "okay";
		};

		rtc@c0010c00 {
			status = "okay";
		};

		nexell_usbphy: nexell-usbphy@c0012000 {
			status = "okay";
		};

		ehci@c0030000 {
			status = "okay";
			port@0 {
				status = "okay";
			};
		};

		ohci@c0020000 {
			status = "okay";
			port@0 {
				status = "okay";
			};
		};

		dwc2otg@c0040000 {
			status = "okay";
		};

		i2c_0: i2c@c00a4000 {
			samsung,i2c-max-bus-freq = <400000>;
			status = "okay";

			#address-cells = <1>;
			#size-cells = <0>;

			es8316: es8316@11 {
				#sound-dai-cells = <0>;
				compatible = "everest,es8316";
				reg = <0x11>;
			};
		};

		i2c_1: i2c@c00a5000 {
			status = "okay";
		};

		i2c_2: i2c@c00a6000 {
			samsung,i2c-max-bus-freq = <200000>;
			status = "okay";

			#address-cells = <1>;
			#size-cells = <0>;

			onewire_ts@2f {
				compatible = "onewire";
				reg = <0x2f>;
				interrupt-parent = <&gpio_c>;
				interrupts = <16 IRQ_TYPE_EDGE_FALLING>;
				pinctrl-names = "default";
				pinctrl-0 = <&touchpanel_irq>;
			};

			ft5x06_ts@38 {
				compatible = "edt,edt-ft5x06", "ft5x06";
				reg = <0x38>;
				interrupt-parent = <&gpio_c>;
				interrupts = <16 IRQ_TYPE_EDGE_FALLING>;
			};

			goodix_ts@5d {
				compatible = "goodix,gt9xx";
				reg = <0x5d>;
				interrupt-parent = <&gpio_c>;
				interrupts = <16 IRQ_TYPE_EDGE_FALLING>;
				goodix,irq-gpio = <&gpio_c 16 0>;
				goodix,rst-gpio = <&gpio_c 15 0>;
			};

			goodix_ts@14 {
				compatible = "goodix,gt9xx";
				reg = <0x14>;
				interrupt-parent = <&gpio_c>;
				interrupts = <16 IRQ_TYPE_EDGE_FALLING>;
				goodix,irq-gpio = <&gpio_c 16 0>;
			 	goodix,rst-gpio = <&gpio_c 15 0>;
			};

			hx8528a_ts@48 {
				compatible = "himax,hx8528-a";
				reg = <0x48>;
				interrupt-parent = <&gpio_c>;
				interrupts = <16 IRQ_TYPE_EDGE_FALLING>;
			};

			it7260_ts@46 {
				compatible = "ite,it7260";
				reg = <0x46>;
				interrupt-parent = <&gpio_c>;
				interrupts = <16 IRQ_TYPE_EDGE_FALLING>;
			};

			st1572_ts@55 {
				compatible = "sitronix,st1572";
				reg = <0x55>;
				interrupt-parent = <&gpio_c>;
				interrupts = <16 IRQ_TYPE_EDGE_FALLING>;
			};

		};

		i2s_0: i2s@c0055000 {
			#sound-dai-cells = <1>;
			master-mode = <1>;
			mclk-in = <0>;
			trans-mode = <0>;
			frame-bit = <32>;
			sample-rate = <48000>;
			pre-supply-mclk = <1>;
			status = "okay";
		};

		pinctrl@C0010000 {
			key_power: key_power {
				nexell,pins = "alive-0";
				nexell,pin-function = <0>;
				nexell,pin-pull = <1>;
				nexell,pin-strength = <0>;
			};

			onewire_pin: onewire-pin {
				nexell,pins = "gpioc-24";
				nexell,pin-function = <1>;
				nexell,pin-pull = <2>;
				nexell,pin-strength = <0>;
			};

			touchpanel_irq: touchpanel-irq {
				nexell,pins = "gpioc-16";
				nexell,pin-function = <1>;
				nexell,pin-pull = <2>;
				nexell,pin-strength = <0>;
			};

			bt_flow_gpio: bt_flow_gpio {
				nexell,pins = "gpioc-5", "gpioc-6";
				nexell,pin-function = <1>;
				nexell,pin-pull = <2>;
				nexell,pin-strength = <0>;
			};

			bt_cfg_en: bt_cfg_en {
				nexell,pins = "gpiob-8";
				nexell,pin-function = <0>;
				nexell,pin-pull = <2>;
				nexell,pin-strength = <0>;
			};

			cfg_wlanen: cfg-wlanen {
				nexell,pins ="gpiob-24";
				nexell,pin-function = <1>;
				nexell,pin-pull = <2>;
				nexell,pin-strength = <0>;
				nexell,pin-dir = <1>;
				nexell,pin-val = <1>;
			};

			cfg_wlanhostwake: cfg-wlanhostwake {
				nexell,pins = "gpioc-17";
				nexell,pin-function = <2>;
				nexell,pin-pull = <0>;
				nexell,pin-strength = <0>;
			};

			led1_gpio: leds-gpio {
				nexell,pins ="gpiob-12";
				nexell,pin-function = <2>;
				nexell,pin-pull = <2>;
				nexell,pin-strength = <0>;
			};
		};

		scaler@c0066000 {
			status = "okay";
		};

	};	/*** soc ***/

	mach: board {
		compatible = "friendlyelec,board";
		machine = "NANOPI3";
		hwrev = <255>;
		model = "NanoPi 3 Series";
	};

	panel: panel-friendlyelec {
		compatible = "lcds";
		status = "okay";

		/*
		pinctrl-names = "default";
		pinctrl-0 = <&dp_rgb_vclk &dp_rgb_vsync &dp_rgb_hsync
			&dp_rgb_de &dp_rgb_R &dp_rgb_G &dp_rgb_B>;
		*/

		port {
			lcd_panel: endpoint {
			};
		};
	};

	onewire_pwm {
		compatible = "onewire";
		reg = <PHYS_BASE_PWM 0x1000>;
		interrupt-parent = <&gic>;
		interrupts = <0 IRQ_PWM_INT3 0>;
		pwms = <&pwm 3 104166 0>;  /* 1000000000/9600 */
		io,gpio = <&gpio_c 15 0>;
		pinctrl-names = "default";
		pinctrl-0 = <&onewire_pin>;
	};

	gpio_key: gpio_keys {
		compatible = "gpio-keys";
		#address-cells = <1>;
		#size-cells = <0>;
		pinctrl-names = "default";
		pinctrl-0 = <&key_power>;

		power {
			label = "Power";
			gpios = <&alive_0 0 GPIO_ACTIVE_LOW>;
			linux,code = <KEY_POWER>;
			gpio-key,wakeup;
		};
	};

	leds: gpio-leds {
		compatible = "gpio-leds";
		pinctrl-names = "default";
		pinctrl-0 =<&led1_gpio>;

		led@1 {
			gpios = <&gpio_b 12 GPIO_ACTIVE_LOW>;
			label = "status_led";
			linux,default-trigger = "heartbeat";
			linux,default-trigger-delay-ms = <0>;
		};
	};

	spdif_out: spdif-out {
		#sound-dai-cells = <0>;
		compatible = "linux,spdif-dit";
	};

	simple_card: sound {
		compatible = "nexell,simple-audio-card";
		simple-audio-card,name = "nanopi3-audio";
		simple-audio-card,mclk-fs = <256>;
		simple-audio-card,widgets =
			"Headphone", "Out Jack";
		simple-audio-card,routing =
			"Out Jack", "HPOL",
			"Out Jack", "HPOR";
		status = "okay";

		simple-audio-card,dai-link@0 {
			format = "i2s";
			cpu {
				sound-dai = <&i2s_0 0>;
			};

			codec {
				sound-dai = <&es8316>;
			};
		};

		simple-audio-card,dai-link@1 {
			cpu {
				sound-dai = <&spdif_tx 0>;
			};

			codec {
				sound-dai = <&spdif_out>;
			};
		};
	};

	wlan {
		compatible = "samsung,brcm-wlan";
		gpios = <&gpio_b 24 0  /* WLAN_EN */
			 &gpio_c 17 0>; /* WLAN_HOST_WAKE */
		status = "okay";
	};

	bt_bcm {
		compatible = "broadcom,bcm4343";
		reset-gpios = <&gpio_b 8 0>;
		rts-gpios = <&gpio_c 6 0>;
		cts-gpios = <&gpio_c 5 0>;
		pinctrl-names = "default", "gpios";
		pinctrl-0 = <&bt_cfg_en>, <&serial1_flow>;
		pinctrl-1 = <&bt_cfg_en>, <&bt_flow_gpio>;
		status = "okay";
	};

	nexell-ion@0 {
		compatible = "nexell,ion";

		heap_sys_user@0 {
			heap-type = "ion_system";
		};

		heap_sys_contig@0 {
			heap-type = "ion_system_contig";
		};

		heap_dma@0 {
			heap-type = "ion_dma";
		};
	};
};

&i2c1_pin {
	nexell,pin-pull = <NX_PIN_PULL_UP>;
	nexell,pin-strength = <1>;
};

&pwm {
	status = "okay";
	pinctrl-0 = <&pwm0_pin &pwm1_pin &pwm2_pin>;
	samsung,pwm-outputs = <0>, <1>, <2>, <3>;
};

&dw_mmc_1 {
	num-slots = <1>;
	bus-width = <4>;
	cap-sd-highspeed;
	cd-type-external;
	broken-cd;
	pm-ignore-notify;
	keep-power-in-suspend;
	powered-resumed-nonremovable-card;
	cd-type = <2>;
	clock-frequency = <100000000>;
	nexell,drive_dly = <0x0>;
	nexell,drive_shift = <0x02>;
	nexell,sample_dly = <0x00>;
	nexell,sample_shift = <0x01>;
	pinctrl-names = "default";
	pinctrl-0 = <&sdmmc1_cclk &sdmmc1_cmd &sdmmc1_bus4
		     &cfg_wlanen &cfg_wlanhostwake>;
};

&vip_0 {
	clk-base = <0xc00c1000>;
	status = "okay";
};

&clipper_0 {
	interface_type = <NX_CAPTURE_INTERFACE_PARALLEL>;
	pinctrl-names = "default";
	pinctrl-0 = <&vid0_data_clk &vid0_sync>;
	clock_source = <4>;
	data_order = <NX_VIN_Y0CBY1CR>;
	port = <0>;
	external_sync = <0>;
	interlace = <0>;
	status = "okay";

	sensor {
		type = <NX_CAPTURE_SENSOR_I2C>;
		i2c_name = "ov5640";
		i2c_adapter = <0>;
		addr = <0x3C>;
	};
};

&dp_drm {
	status = "okay";
	ports {
		port@0 {
			reg = <0>;
			back_color = < 0x0 >;
			color_key = < 0x0 >;
			plane-names = "video", "rgb", "primary";
		};
		port@1 {
			reg = <1>;
			back_color = < 0x0 >;
			color_key = < 0x0 >;
			plane-names = "video", "primary";
		};
	};
};



&dsi {
    status = "okay";
    rockchip,lane-rate = <400>;
    dsi_panel: panel@0 {
        status = "okay";
        compatible = "simple-panel-dsi";
		reg = <0>;
		reset-gpio = <&gpio_a 21 0>;
		power-on-delay= <50>;
		reset-delay = <100>;
		init-delay = <100>;
       // backlight = <&backlight>;
      //  reset-gpios = <&gpio_a 21 0>;
      //  reset-delay-ms = <10>;
      //  enable-delay-ms = <60>;
      //  prepare-delay-ms = <60>;
      //  unprepare-delay-ms = <60>;
      //  disable-delay-ms = <60>;
		dsi,flags = <(MIPI_DSI_MODE_VIDEO | MIPI_DSI_MODE_VIDEO_BURST)>;

		dsi,format = <MIPI_DSI_FMT_RGB888>;
        dsi,lanes  = <4>;
		panel-init-sequence = [
                                  
            39 0B 04 FF 98 81 03  // Sequence format  BYTE1=DSC Command TYPE  | BYTE2=Delay in milliseconds  | BYTE3= Number of bytes in command | BYTE4/5/6/7= ILI9881 Command
            15 0B 02 01 00        // Sequence format  BYTE1=DSC Command TYPE  | BYTE2=Delay in milliseconds  | BYTE3= Number of bytes in command | BYTE4/5= ILI9881 Command
            15 0B 02 02 00
            15 0B 02 03 72
            15 0B 02 04 00
            15 0B 02 05 00
            15 0B 02 06 09
            15 0B 02 07 00
            15 0B 02 08 00
            15 0B 02 09 01
            15 0B 02 0A 00
            15 0B 02 0B 00
            15 0B 02 0C 01
            15 0B 02 0D 00
            15 0B 02 0E 00
            15 0B 02 0F 00
            15 0B 02 10 00
            15 0B 02 11 00
            15 0B 02 12 00
            15 0B 02 13 00
            15 0B 02 14 00
            15 0B 02 15 00
            15 0B 02 16 00
            15 0B 02 17 00
            15 0B 02 18 00
            15 0B 02 19 00
            15 0B 02 1A 00
            15 0B 02 1B 00
            15 0B 02 1C 00
            15 0B 02 1D 00
            15 0B 02 1E 40
            15 0B 02 1F 80
            15 0B 02 20 05
            15 0B 02 21 02
            15 0B 02 22 00
            15 0B 02 23 00
            15 0B 02 24 00
            15 0B 02 25 00
            15 0B 02 26 00
            15 0B 02 27 00
            15 0B 02 28 33
            15 0B 02 29 02
            15 0B 02 2A 00
            15 0B 02 2B 00
            15 0B 02 2C 00
            15 0B 02 2D 00
            15 0B 02 2E 00
            15 0B 02 2F 00
            15 0B 02 30 00
            15 0B 02 31 00
            15 0B 02 32 00
            15 0B 02 33 00
            15 0B 02 34 04
            15 0B 02 35 00
            15 0B 02 36 00
            15 0B 02 37 00
            15 0B 02 38 3C
            15 0B 02 39 00
            15 0B 02 3A 40
            15 0B 02 3B 40
            15 0B 02 3C 00
            15 0B 02 3D 00
            15 0B 02 3E 00
            15 0B 02 3F 00
            15 0B 02 40 00
            15 0B 02 41 00
            15 0B 02 42 00
            15 0B 02 43 00
            15 0B 02 44 00
            15 0B 02 50 01
            15 0B 02 51 23
            15 0B 02 52 45
            15 0B 02 53 67
            15 0B 02 54 89
            15 0B 02 55 AB
            15 0B 02 56 01
            15 0B 02 57 23
            15 0B 02 58 45
            15 0B 02 59 67
            15 0B 02 5A 89
            15 0B 02 5B AB
            15 0B 02 5C CD
            15 0B 02 5D EF
            15 0B 02 5E 11
            15 0B 02 5F 01
            15 0B 02 60 00
            15 0B 02 61 15
            15 0B 02 62 14
            15 0B 02 63 0E
            15 0B 02 64 0F
            15 0B 02 65 0C
            15 0B 02 66 0D
            15 0B 02 67 06
            15 0B 02 68 02
            15 0B 02 69 07
            15 0B 02 6A 02
            15 0B 02 6B 02
            15 0B 02 6C 02
            15 0B 02 6D 02
            15 0B 02 6E 02
            15 0B 02 6F 02
            15 0B 02 70 02
            15 0B 02 71 02
            15 0B 02 72 02
            15 0B 02 73 02
            15 0B 02 74 02
            15 0B 02 75 01
            15 0B 02 76 00
            15 0B 02 77 14
            15 0B 02 78 15
            15 0B 02 79 0E
            15 0B 02 7A 0F
            15 0B 02 7B 0C
            15 0B 02 7C 0D
            15 0B 02 7D 06
            15 0B 02 7E 02
            15 0B 02 7F 07
            15 0B 02 80 02
            15 0B 02 81 02
            15 0B 02 82 02
            15 0B 02 83 02
            15 0B 02 84 02
            15 0B 02 85 02
            15 0B 02 86 02
            15 0B 02 87 02
            15 0B 02 88 02
            15 0B 02 89 02
            15 0B 02 8A 02
            39 0B 04 FF 98 81 04  // Set to Page 4 Command
            15 0B 02 6C 15        // Set VCORE Setting to 0x15
            15 0B 02 6E 2A        // Set Power Control2 to 0x2A
            15 0B 02 6F 34        // Set Power Control3 to 0x34
            15 0B 02 3A 94        // Command 0x3A not in 0.92 spec version
            15 0B 02 8D 14        // Set Power Control4 to 0x14
            15 0B 02 87 BA        // Command 0x87 not in 0.92 spec version
            15 0B 02 26 76        // Command 0x26 not in 0.92 spec version
            15 0B 02 B2 D1        // Command 0xB2 not in 0.92 spec version
            15 0B 02 B5 06        // Command 0xB5 not in 0.92 spec version
            39 0B 04 FF 98 81 01  // Set to Page 1 Command
            15 0B 02 22 09        // Set Panel Operation Mode to 0x0B
            15 0B 02 31 00        // Set Display Inversion to 0x00
            15 0B 02 53 90        // Set VCOM Control1-2 to 0x90
            15 0B 02 55 A2        // Set VCOM Control1-4 to 0xA2
            15 0B 02 50 B7        // Set Power Control1-1 to 0xB7
            15 0B 02 51 B7        // Set Power Control1-2 to 0xB7
            15 0B 02 60 22        // Set Source Timing Adjust-1 to 0x22
            15 0B 02 61 00        // Set Source Timing Adjust-2 to 0x00
            15 0B 02 62 19        // Set Source Timing Adjust-3 to 0x19
            15 0B 02 63 10        // Set Source Timing Adjust-4 to 0x10
            15 0B 02 A0 08        // Set Positive Gamma Correction-1 to 0x08
            15 0B 02 A1 1A        // Set Positive Gamma Correction-2 to 0x1A
            15 0B 02 A2 27        // Set Positive Gamma Correction-3 to 0x27
            15 0B 02 A3 15        // Set Positive Gamma Correction-4 to 0x15
            15 0B 02 A4 17        // Set Positive Gamma Correction-5 to 0x17
            15 0B 02 A5 2A        // Set Positive Gamma Correction-6 to 0x2A
            15 0B 02 A6 1E        // Set Positive Gamma Correction-7 to 0x1E
            15 0B 02 A7 1F        // Set Positive Gamma Correction-8 to 0x1F
            15 0B 02 A8 8B        // Set Positive Gamma Correction-9 to 0x8B
            15 0B 02 A9 1B        // Set Positive Gamma Correction-10 to 0x1B
            15 0B 02 AA 27        // Set Positive Gamma Correction-11 to 0x27
            15 0B 02 AB 78        // Set Positive Gamma Correction-12 to 0x78
            15 0B 02 AC 18        // Set Positive Gamma Correction-13 to 0x18
            15 0B 02 AD 18        // Set Positive Gamma Correction-14 to 0x18
            15 0B 02 AE 4C        // Set Positive Gamma Correction-15 to 0x4C
            15 0B 02 AF 21        // Set Positive Gamma Correction-16 to 0x21
            15 0B 02 B0 27        // Set Positive Gamma Correction-17 to 0x27
            15 0B 02 B1 54        // Set Positive Gamma Correction-18 to 0x54
            15 0B 02 B2 67        // Set Positive Gamma Correction-19 to 0x67
            15 0B 02 B3 39        // Set Positive Gamma Correction-20 to 0x39
            15 0B 02 C0 08        // Set Negative Gamma Correction-1 to 0x08
            15 0B 02 C1 1A        // Set Negative Gamma Correction-2 to 0x1A
            15 0B 02 C2 27        // Set Negative Gamma Correction-3 to 0x27
            15 0B 02 C3 15        // Set Negative Gamma Correction-4 to 0x15
            15 0B 02 C4 17        // Set Negative Gamma Correction-5 to 0x17
            15 0B 02 C5 2A        // Set Negative Gamma Correction-6 to 0x2A
            15 0B 02 C6 1E        // Set Negative Gamma Correction-7 to 0x1E
            15 0B 02 C7 1F        // Set Negative Gamma Correction-8 to 0x1F
            15 0B 02 C8 8B        // Set Negative Gamma Correction-9 to 0x8B
            15 0B 02 C9 1B        // Set Negative Gamma Correction-10 to 0x1B
            15 0B 02 CA 27        // Set Negative Gamma Correction-11 to 0x27
            15 0B 02 CB 78        // Set Negative Gamma Correction-12 to 0x78
            15 0B 02 CC 18        // Set Negative Gamma Correction-13 to 0x18
            15 0B 02 CD 18        // Set Negative Gamma Correction-14 to 0x18
            15 0B 02 CE 4C        // Set Negative Gamma Correction-15 to 0x4C
            15 0B 02 CF 21        // Set Negative Gamma Correction-16 to 0x21
            15 0B 02 D0 27        // Set Negative Gamma Correction-17 to 0x27
            15 0B 02 D1 54        // Set Negative Gamma Correction-18 to 0x54
            15 0B 02 D2 67        // Set Negative Gamma Correction-19 to 0x67
            15 0B 02 D3 39        // Set Negative Gamma Correction-20 to 0x39
            39 0B 04 FF 98 81 00  // Set to Page 0 Command
            15 0B 02 36 03
            05 0B 01 35
            05 7D 01 11           // Set Sleep Out
            05 7D 01 29           // Set Display On
        ];
		panel-exit-sequence = [
			05 7D 01 28
			05 7D 01 10
		];

        disp_timings: display-timings {
            native-mode = <&timing0>;
			timing0: timing0 {
				clock-frequency = <61000000>;
				hactive = <720>;
				vactive = <1280>;
				hback-porch = <5>;
				hfront-porch = <40>;
				vback-porch = <20>;
				vfront-porch = <20>;
				hsync-len = <10>;
				vsync-len = <4>;
				hsync-active = <0>;
				vsync-active = <0>;
				de-active = <0>;
				pixelclk-active = <0>;
			};
        };
    };
};

&dp_drm_hdmi {
	skip-boot-connect;
	ddc-i2c-bus = <&i2c_1>;
	status = "okay";

	mode {
		width = <1280>;
		height = <720>;
		refresh = <60>;
	};
};

&i2c0_pin {
	nexell,pin-strength = <NX_PIN_STR1>;
};

&spi_0 {
	status = "okay";
	cs-gpios = <&gpio_c 30 0>;

	spidev0: spidev@0 {
		status = "okay";
		compatible = "linux,spidev";
		reg = <0>;
		spi-max-frequency = <10000000>;
		controller-data {
			samsung,spi-feedback-delay = <0>;
		};
	};

	t28tft0: fbtft@0 {
		status = "disabled";
		compatible = "sitronix,st7789v";
		reg = <0>;
		spi-max-frequency = <50000000>;
		rotate = <90>;
		fps = <33>;
		buswidth = <8>;
		dc-gpios = <&gpio_b 28 0>;
		reset-gpios = <&gpio_d 8 0>;
		debug = <0x0>;
		controller-data {
			samsung,spi-feedback-delay = <0>;
		};
	};
};
